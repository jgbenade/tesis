\chapter{Enumeration of MOLS}
% put these two lines after every \chapter{} command
\vspace{-2em}
\minitoc

Chapter 3 will give an overview of the main equivalence classes of \lat s and motivate why the decision was made to focus only on enumerating main classes. Some examples of existing enumeration techniques for MOLS will be described, after which an algorithm for the enumeration of main classes will be designed.  The algorithm will be verified by comparing its results with previously published findings.

\section{Historical overview}

\section{Main classes of MOLS}
\lat s which can be generated from one another by changing the order of their rows and/or columns, and/or by renaming their symbols, are said to be \emph{isotopic},  while \lat s formed by uniformly applying a permutation to all $n^2$ $3$-tuples $(i,j, \l(i,j))$ are called \emph{conjugates}. For example, applying the permutation $\binom{0 \ 1 \ 2}{1\ 0\ 2}$ to the $3$-tuple $(i,j, \l(i,j))$ yields the transpose $(j,i, \l(i,j))$ of $\l$. 
%A maximal  set of isotopic \lat s, together with all their conjugates, form a \emph{main class} of \lat s.  It is possible to show that \lref{l1}, \lref{l2}, \lref{l3} and \lref{l4} are all in the same main class by reordering the rows of \lref{l1} to find \lref{l2}, transposing \lref{l1} to form \lref{l4} and,  finally, reordering the columns of \lref{l4} to form \lref{l3}.
%The order of the rows of \lref{l1}, for example, may be changed to form \lref{l2}, similarly,. It is possible the rename the symbols of \lref{l2} to find \lref{l3} and   show that \lref{l1}, \lref{l2} and \lref{l3} are isotopic and in the same main class.

The notions of    isotopic and  conjugate \lat s as well as that of main classes may be extended to $k$-MOLS.  All $k$-MOLS which may be generated by row, column and symbol permutations from  a given $k$-MOLS are isotopic, with the additional constraint that the same row or column permutation must be applied to all $k$ \lat s in the  $k$-MOLS in order to maintain orthogonality (the symbol sets, however, may be renamed independently). Conjugates, in this case, are $k$-MOLS formed by uniformly applying permutations to the $(k+2)$-tuples $(i,j, \l_0(i,j), \ldots, \l_{k-1}(i,j))$ and a main class consists of a given $k$-MOLS, together with its $(k+2)!$ conjugates as well as their respective isotopic $k$-MOLS.

\section{Enumeration methodology} \label{Menum}
An exhaustive enumeration of   $k$-MOLS of order $n$ may be carried out by    the orderly generation of the class representatives of every main class. The pseudo-code of such an enumeration procedure is given as Algorithm \ref{Alg:enumerate}.
A backtracking tree-search is implemented in Algorithm \ref{Alg:enumerate} for  constructing $k$-MOLS of order $n$,  one universal at a time in such a way that,
 for $i \in \mathbb{Z}_n$ and $m \in \mathbb{Z}_k$, the active nodes on level $i.m$  of the search tree correspond to the lexicographically smallest partial $k$-MOLS whose \lat s $\l_0, \ldots, \l_{m}$ each contains $i+1$
universals and whose \lat s $\l_{m+1}, \ldots, \l_{k}$ each contains $i$ universals.  The inactive nodes in the search tree represent  those partial $k$-MOLS which cannot be completed to be a  class representative  or in which the partial \lat s are no longer pairwise orthogonal. On level $i.(k\!-\!1)$  of the search tree the  universal for the symbol $i$ has been inserted in all the \lat s $\l_0, \ldots, \l_{k-1}$ of the partial $k$-MOLS  and the next universal to insert is $u_{i+1}{(0)}$; as this level marks the completion of the partial $k$-MOLS up to the symbol $i$, it is also referred to simply as level $i$.
 \begin{algorithm}[!b]
 %\SetKwFor{If}{if}{then}{}
\SetKwInOut{Input}{input}\SetKwInOut{Output}{output} 
\Input{A partial $k$-MOLS $\mathcal{P}$}
\Output{All completed class representatives in the subtree rooted at $\p$}
 \BlankLine
\Begin{
\If{$\p$ is complete}{
	\eIf{\emph{none of the conjugates of $\p$ has smaller isotopics }}{
		output $\p$ as class representative\\
		return
	}{return}
}
\For{\emph{every candidate universal $c$}}{
	\If{\emph{$c$ preserves orthogonality and is valid by Theorem 1 (c)}}{
		\If{\emph{$\p\cup c$ has no smaller isotopic $k$-MOLS}}{
		enumerateMOLS($\p\cup c$)	}
	} 
} 
}	
\caption{enumerateMOLS($\p$) \label{Alg:enumerate}% \vspace{-2.5cm}  
}
\end{algorithm}


Suppose that the partial $k$-MOLS, $\mathcal{P}$, has been constructed on level $i.\ell$ of the search tree, in other words, the next universal to insert into $\mathcal{P}$ is   $u_i{(\ell+1)}$, or  $u_{i+1}{(0)}$ if $\ell = k-1$.   Let $U(\mathcal{P})$ be the set of all universals in the partial $k$-MOLS $\mathcal{P}$, $U(\mathcal{P}_{\ell+1})$ the set of  all universals in $\p$, excluding the universals of $\l_{\ell+1}$ (the \lat \ into which a universal is currently being added) and denote the set of feasible candidate universals by $\mathcal{C}(\p)$.  The node in the search tree representing $\p$ thus has $|\mathcal{C}(\p)|$  children, any number of which may be inactive. %, subject to the contraints that the partially completed \lat s in any partial $k$-MOLS $\p'$ represented by a  child of $\p$ must be pairwise orthogonal, and that  $\p'$ must be the lexicographically smallest $k$-MOLS in its main class.

To verify orthogonality in a child $ \p \cup c$ of $\p$, for some candidate universal $c \in \mathcal{C}(\p)$, it is necessary to confirm that the relative cycle structure of  $c$ and every permutation $p\in  U(\p_{\ell+1})$ has exactly one fixed point. The following result by Kidd \emph{et al.} \cite[Theorem 4.3.2]{Kidd2012} provide an easy way of determining whether a partial $k$-MOLS  $\m$ is the lexicographically smallest partial $k$-MOLS in its main class.
\begin{theorem}{\cite[Theorem 4.3.2]{Kidd2012} }
If $\m= (\l_0,     \ldots, \l_{k-1})$ is the lexicographically smallest $k$-MOLS of order $n$ in its main class, then (a) $u_0{(0)}$ is the identity permutation, (b) $u_0{(1)}$ is a cycle structure representative, and (c) the relative cycle structure of two universal permutations $u_i{(j)}, u_{\ell}{(m)}$ is not {lexicographically} smaller than the cycle structure of $u_0{(1)}\in U(\m)$ for all $i, j \in \mathbb{Z}_n$ and $j, m\in \mathbb{Z}_n$.
\end{theorem}
According to Theorem 1 (a) and (b) there is a very limited number of feasible zero universals in $\l_0$ and $\l_1$, and by Theorem 1 (c) no  relative cycle structure calculated while verifying orthogonality may be smaller than the cycle structure of $u_0{(1)}$ if $\p \cup c$ is to be the lexicographically smallest partial $k$-MOLS in its main class.
%Once it is confirmed that the candidate universal $u_i^{(\ell)}$ is orthogonal to all the existing universals and that it does not lead to a smaller relative cycle structure than the cycle structure of $u_0^{(1)}$, 
 
 \begin{figure}[b!]
 \centering 
  \begin{sideways}     
       \input{52boom.pdf_t}     
  \end{sideways}
  
  \vspace*{.4cm} \caption{The backtracking enumeration search tree for 2-MOLS of order 5. At every leaf it is either indicated that (a) no candidate universals preserve orthogonality, or that (b) a lexicographically smaller partial MOLS has been found in the same main class, or  that (c) a class representative has been found.}\label{figtree}
\end{figure}

If  $\p \cup c$ passes this test, then  all possible pairs of universals  $u_a{(j)}, u_{b}{(m)}$ in $ \p \cup c$ or its transpose  $(\p \cup c)^T$  with a relative cycle structure equal to the cycle structure of $u_0{(1)}$ are mapped to the pair of universals $u_0{(0)}, u_{0}{(1)}$ to form a new partial $k$-MOLS $(\p \cup c)'$ in the same main class, which is then subjected to a restricted number of row, column and symbol permutations in an attempt to find a lexicographically smaller partial MOLS. 
More specifically, in order to ensure that the universal  $u_0(0)$  in $(\p \cup c)'$ remains unchanged it is necessary to apply any potential permutation to both the row and column indices, furthermore, for $u_0(1)$ with cycle structure $z_1  z_{2}^{n_2} \ldots z_{p}^{n_p} $ to be unaffected by the permutations the set of potential permutations is restricted to only the $\prod_{i=1}^{i\leq p} i ^{n_i} \times n_i!$ permutations that are found by rotating and reordering the cycles of  $u_0(1)$. This step of the enumeration process, referred to in line 10 of   Algorithm 1, is called the \texttt{isSmallest} test.
If such a smaller partial MOLS is found, the node representing $\p \cup c$ becomes inactive and the next candidate universal is inspected for insertion into $\p$. Otherwise, a new list of candidate universals are generated for insertion into $\p \cup c$ and the search restarts one level lower down  the tree. Whenever there are no more candidate universals to inspect, the search returns to the previous level.  
For a completed $k$-MOLS $\p$, on  level $n-1$, the mappings and transformations described above are performed on all of the conjugates of $\p$ to confirm that none of these conjugates have a lexicographically smaller isotopic $k$-MOLS than $\p$. 


This enumeration process for 2-MOLS of order 5 is represented  in Figure \ref{figtree} (the same example may be found in \cite{Kidd2012}).  According to Theorem 1, $u_0{(0)}$ must be the identity permutation and $u_0{(1)}$ a cycle structure representative, of which there are two possibilities for order 5, namely $z_1z_2^2$ and $z_1z_4$ (note that there must be exactly one 1-cycle to ensure orthogonality with the identity permutation).  Two partial $k$-MOLS are said to be in the same \emph{section} of the search tree if the respective $u_0{(1)}$ universals are the same cycle structure representative; the enumeration of $2$-MOLS of order 5 therefore consists of two sections.
Where branches become inactive it is indicated that either (a) no candidate universals preserve orthogonality,  (b) a lexicographically smaller partial MOLS has been found in the same main class, or   (c) a class representative had been found. 
One 2-MOLS is found in the section of $z_1z_1^2$ and no structurally different $2$-MOLS is found  in the section of $z_1z_4$,  although a completed candidate 2-MOLS is uncovered which, upon inspection, is shown to be in the same main class  as the first one but lexicographically larger.
  \begin{table}[b]
 \centering
\begin{tabular}{crrrrrrrrr}
\toprule
Section& \multicolumn{8}{c}{Level}& Time ($s$)\\
\cmidrule(lr){2-9}
 & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 &   \\ \midrule 
$z_1z_2^2z_3$ &17 & $12\,501\,028$ & $1\,484\,518\,094$ & $18\,814\,494$ & 55 & 23 & 22 & 20 & $775\,321$ \\ 
$z_1z_2^1z_5$ &14 & $3\,358\,273$ & $61\,708\,802$ & $63\,157$ & 97 & 92 & 84 & 17 & $60\,011$ \\ 
$z_1z_3z_4$ &5 & $52\,059$ & $5\,283$ & 1 & 0 & 0 & 0 & 0 & 93 \\ 
$z_1z_7$ &9 & $37\,403$ & $9\,079$ & 82 & 64 & 53 & 53 & 2 & $111$ \\ \midrule
Total &45 & $15\,948\,763$ & $1\,546\,241\,258$ & $318\,877\,734$ & 216 & 168 & 159 & 39 & $835\,537$ \\ \bottomrule
\end{tabular}\vspace*{.4cm}
\caption{The number of active nodes in every section and on every level of the search tree for enumerating   3-MOLS of order 8, together with the time in seconds that the enumeration of every section took on a 3.2~GHz processor with 8 Gb of RAM.}
\label{83}
\end{table}
The known results in Table \ref{known} were replicated in a validation attempt and details on the enumeration results for $3$-MOLS of order 8 are given in Table \ref{83}. The number of active nodes found  on every level is identical to that found by Kidd \cite{Kidd2012}%in 2012
, while the serialized runtime has been improved from approximately 36 days to just under 10 days, although this improvement may be partially due to the use of different computing platforms. There are 45 active nodes on level 0 (after all of the zero universals have been inserted  and an \iis test has been performed) and these nodes were given as the starting positions from which all of the subtrees were enumerated. It was found that there are 259 and $1\,700$ active nodes on level 0 of the search trees for orders 9 and 10, which may be partitioned into 7 and 8 sections, respectively. Interestingly, the runtime increased from 6 seconds for the enumeration of $3$-MOLS of order 7 to just under 10 days for the $3$-MOLS of order  8, raising serious concerns over the feasibility of the enumeration $3$-MOLS of order 9 and higher. 

\section{On the enumerability of larger order search spaces}

In order to determine the feasibility of enumerating   $3$-MOLS of orders 9 and 10, the algorithm was modified so that it only examines MOLS that are isotopic to a partial MOLS $\p$ after universals of the $i$-th symbol have been inserted into every \lat \ in $\p$. Although this increases the total number of branches of the search tree that survive  to level $i$, it decreases the total number of \iis tests performed during the enumeration, as all branches that would otherwise have been pruned earlier must necessarily have been subjected to at least one \iis test. Furthermore, the effect on the search tree as a whole is minimised, as the exact same number of branches will pass the \iis and proceed to the next symbol. The sizes of the subsequent search trees for orders 9 and 10 were approximated by estimating the total number of nodes in the absence of the \iis test before applying the expected pruning effect of the \iis test to determine the number of active nodes on every level of the tree. Finally, a small number of nodes from one of these levels were used as starting points for the enumeration algorithm so that the the total time it would take to traverse the entire trees could be estimated.
\begin{figure}[t] 
\centering
\begin{minipage}{7.5cm}
  \begin{tikzpicture}
\begin{axis}[xlabel={Starting problem},ylabel={Feasible  universals}, height=6.5cm]
\draw (-10,-35) -- (-10, 3500) [dashed];
\draw (165,-35) -- (165, 3500) [dashed];
\draw (305,-35) -- (305, 3500) [dashed];
\draw (355,-35) -- (355, 3500) [dashed];
\draw (445,-35) -- (445, 3500) [dashed];

% Graph column 2 versus column 0
\addplot+[only marks, mark=triangle*] table[x index=0,y index=1,col sep=space ] {data/83avgunis1.txt};
\addlegendentry{$u_1{(0)}$}% y index+1 since humans count from 1

% Graph column 1 versus column 0    
\addplot+[only marks, mark=x] table[x index=0,y index=2,col sep=space] {data/83avgunis1.txt};
\addlegendentry{$u_1{(1)}$}
\addplot+[only marks, mark=+] table[x index=0,y index=3,col sep=space] {data/83avgunis1.txt};
\addlegendentry{$u_1{(2)}$}
\end{axis}

\end{tikzpicture}

\end{minipage}\qquad
\begin{minipage}{7.5cm}
 \begin{tikzpicture}
\begin{axis}[xlabel={Starting problem},ylabel={Feasible  universals}, height=6.5cm]
\draw (-10,-20) -- (-10, 200) [dashed];
\draw (165,-20) -- (165, 200) [dashed];
\draw (305,-20) -- (305, 200) [dashed];
\draw (355,-20) -- (355, 200) [dashed];
\draw (445,-20) -- (445, 200) [dashed];
% Graph column 2 versus column 0
\addplot+[only marks, mark=triangle*] table[x index=0,y index=1,col sep=space ] {data/83avgunis2.txt};
\addlegendentry{$u_2{(0)}$}% y index+1 since humans count from 1

% Graph column 1 versus column 0    
\addplot+[only marks, mark=x] table[x index=0,y index=2,col sep=space] {data/83avgunis2.txt};
\addlegendentry{$u_2{(1)}$}
\addplot+[only marks, mark=+] table[x index=0,y index=3,col sep=space] {data/83avgunis2.txt};
\addlegendentry{$u_2{(2)}$}

\end{axis}
\end{tikzpicture}
\end{minipage} \vspace{.2cm}
 \caption{The average number of feasible candidate universals $u_i{(j)}$ found for $i = 1,2$ and $j\in \mathbb{Z}_k$ in the enumeration of $3$-MOLS of order $8$ for each of the 45 partial $3$-MOLS which pass the \iis test on level 0 of the search tree. The dashed lines indicate in which section the starting position resides, \emph{i.e.} whether the permutation $u_0{(1)}$ in the initial partial $3$-MOLS has the cycle structure $z_1z_2^2z_3, z_1z_2z_5, z_1z_3z_4$ or $z_1z_7$, in that order. }\label{figunis}\end{figure}
The enumeration tree for $3$-MOLS of order 8 was also traversed to determine the average number of universals that preserve orthogonality and are valid by Theorem 1 (c), \emph{i.e.} the universals that pass the test on line 9 of Algorithm \ref{Alg:enumerate}, for partial $3$-MOLS on different levels of the search tree.
%By enumerating the $3$-MOLS of order 8 in this way it was possible to determine the average number universals that preserve orthogonality and is valid by Theorem 1(3). 

\begin{table}[b]
\parbox{105mm}{
\centering
   \begin{tabular}{lrrrr}
\toprule
 
 & \multicolumn{2}{c}{Order 8}  &   \multicolumn{1}{c}{Order 9} & \multicolumn{1}{c}{Order 10} \\ \cmidrule(lr){2-3} \cmidrule(lr){4-4} \cmidrule(lr){5-5}
  & \multicolumn{1}{c}{Actual}  & \multicolumn{1}{c}{Estimated} & \multicolumn{1}{c}{Estimated} & \multicolumn{1}{c}{Estimated} \\\midrule 
%Level 0 & \textbf{} & \multicolumn{1}{l}{\textbf{}}  & \multicolumn{1}{l}{\textbf{}} & \multicolumn{1}{l}{\textbf{}} \\ 
Level 1 & \multicolumn{1}{r}{\textbf{$2.61\times 10^7$}} & $2.60\times 10^7$ &   $5.79\times 10^{10}$ & $2.41\times 10^{14}$ \\ 
Level 2 & \textbf{$4.34 \times 10^9$} & $3.74\times 10^9$ &    $3.39\times 10^{15}$ & $9.67\times 10^{21}$ \\ 
Level 3 & \textbf{$9.96\times 10^8$} & $9.31\times 10^8$ &    $2.15\times 10^{16}$ &   \\ \bottomrule
\end{tabular}  \vspace{.4 cm}
\caption{A comparison of the actual and estimated total number of nodes on levels $0, 1, 2$ and 3 of the search tree for $3$-MOLS of order 8, together with  similar estimates for orders 9 and 10.}
\label{totalnodes} 
}
\hfill
\parbox{64mm}{
\centering
\begin{tabular}{lrrr}
\toprule
 $n$& 6 & 7 & 8 \\ \midrule %\cmidrule(lr){1-1} \cmidrule(lr){2-4}
Level 0 & 0.15 & 0.071 & 0.032 \\  
Level 1 & 0.55 & 0.483 & 0.573 \\  
Level 2 & 0 & 0.538 & 0.511 \\  \bottomrule
\end{tabular} \vspace{.4cm}
\caption{The average proportions of nodes which pass the \iis test on levels $0,1$ and 2 during the enumeration of 3-MOLS of orders 6, 7 and 8.}
\label{issm}
}
\end{table}
It was found that that this average number of feasible candidate universals, which corresponds to the number of children of a node representing any partial $3$-MOLS  on level $i.\ell$ for $\ell \in \mathbb{Z}_{k-1}$,  depends sensitively on the cycle structure of $u_0{(1)}$, but remains largely constant within a given section of the tree.  Evidence of this may be seen for the 45 active nodes on level 0 of the enumeration tree for $3$-MOLS of order $8$ in  Figure \ref{figunis} for the two sets of universals $u_1{(j)}$ and $u_2{(j)}$ with $j\in \mathbb{Z}_k$. Notice in the figure, that the average number of feasible candidate solutions decreases with every additional universal in $\p$ as it becomes harder to preserve orthogonality.  This  regularity in the number of children of a node of the search tree, as well as its sensitive dependence on the cycle structure of $u_1{(0)}$ was also observed in the search trees for $3$-MOLS of orders $7$, $9$ and $10$. 

These properties make it possible to estimate the average number of children of any partial $3$-MOLS by only examining a very small random selection of partial $3$-MOLS that are on the same level and in the same section of the tree. This process was repeated on every level  of the tree in order to estimate the total number 
%  \begin{wraptable}{r}{105mm}
%  \begin{tabular}{lrrrr}
%\toprule
%&  \multicolumn{4}{c}{$n$} \\
% & \multicolumn{1}{c}{8 - Actual}  & \multicolumn{1}{c}{8 - Est.} & \multicolumn{1}{c}{9} & \multicolumn{1}{c}{10} \\ \midrule\midrule 
%%Level 0 & \textbf{} & \multicolumn{1}{l}{\textbf{}}  & \multicolumn{1}{l}{\textbf{}} & \multicolumn{1}{l}{\textbf{}} \\ 
%Level 1 & \multicolumn{1}{r}{\textbf{$2.61\times 10^7$}} & $2.60\times 10^7$ &   $5.79\times 10^{10}$ & $2.41\times 10^{14}$ \\ 
%Level 2 & \textbf{$4.34 \times 10^9$} & $3.74\times 10^9$ &    $3.39\times 10^{15}$ & $9.67\times 10^{21}$ \\ 
%Level 3 & \textbf{$9.96\times 10^8$} & $9.31\times 10^8$ &    $2.15\times 10^{16}$ &   \\ \bottomrule
%\end{tabular} \vspace{.4cm}
%\caption{A comparison of the actual and estimated total number of nodes on levels 0,1,2 and 3 of the enumeration tree of order 8, together with   estimates of the treefor orders 9 and 10.}
%\label{totalnodes}
%\end{wraptable}
of nodes in the search tree for $3$-MOLS of orders 8, 9 and 10.  This estimate  proved to be fairly accurate for order 8, as may be seen in Table \ref{totalnodes}.


In order to   estimate the number of active nodes on levels 1 and 2 of the search tree, the pruning effect of the \texttt{isSmallest} test must be applied to these estimated total numbers of nodes on every level of the tree. Let $p_i$ denote the percentage of partial $3$-MOLS which pass the \iis test on level $i$. The values of $p_0, \, p_1$ and $p_2$ for orders $6,7$ and 8 may be seen in Table \ref{issm}. Notice that less than 10\% of the  nodes on level 0 are active, and that this value is approximately 50\% for levels 1 and 2. Based on this evidence, the numbers of active nodes on levels 1 and 2 of the search trees for orders 9 and 10 were estimated for three values of $p=p_1=p_2$, specifically $p=0.5$ together with  expected over and under estimate values, $p=0.4$ and $p =0.6$. Note that the pruning effect is carried forward through the tree, \emph{i.e.} if $p=0.5$, then 50\% of  the nodes on level 1 are considered inactive, which implies that half the nodes on level 2 would not have been reached at all so that only 25\% of the total number of nodes on level 2 are considered active.   For order 9 the number of active nodes of level 1 (\emph{i.e.} the number of partial $3$-MOLS with all 0 and 1 universals filled in which pass  the \iis test) is estimated to be between $2.32\times 10^{10}$ and $3.47\times 10^{10}$, depending on the value of $p$, and for order 10 this number grows to approximately $1.21\times 10^{14}$.  The remainder of the estimated numbers of active nodes  may be found in Table \ref{activenodes}. 

To gather insight into the potential total runtime of the enumeration algorithm for $3$-MOLS of orders 9 and 10, a representative sample of active nodes on level 1 of the respective search trees   was used as starting points for Algorithm \ref{Alg:enumerate}, after which %The time to completion,  like the average number of active nodes, depend  largely on the cycle structure of $u_0^{(0)}$ in the starting position, so a 
the   number of active nodes was multiplied by the weighted average time to completion. To enable comparison between computing systems of different speeds the estimated time to completion is expressed in GHz-days, the number of days that a single 1Ghz processor would take to complete the computation. It is expected that a complete enumeration of $3$-MOLS of order 9 would take approximately $5.64\times 10^{8}$ GHz-days, while for order 10 this is expected to  take approximately $1.42\times 10^{18}$~GHz-days (these estimates may also be found in Table \ref{activenodes}).
%\begin{table}[t]
%\begin{tabular}{ c|r|rrr|rrr }
%\hline
%Order & \multicolumn{1}{c|}{8} & \multicolumn{3}{c}{9}  & \multicolumn{3}{|c}{10}   \\ 
%$p$ & \multicolumn{1}{l|}{} & \multicolumn{1}{c}{0.4} & \multicolumn{1}{c}{0.5} &\multicolumn{1}{c}{0.6} & \multicolumn{1}{|c}{0.4} & \multicolumn{1}{c}{0.5} &\multicolumn{1}{c}{0.6} \\ \hline\hline
%%Level 0 & 45 & 259 & 259 & 259 & 1700 & 1700 & 1700 \\ 
%Level 1 & $15\,948\,763$ & $2.32\times 10^{10}$ & $2.89\times 10^{10}$ & $3.47\times 10^{10}$  & $9.65\times 10^{13}$ & $1.21\times 10^{14}$ & $1.44\times 10^{14}$ \\ 
%Level 2 & $1\,546\,241\,258$ & $5.43\times 10^{14}$ & $8.48\times 10^{14}$ & $1.22\times 10^{15}$  & $1.55\times 10^{21}$ & $2.42\times 10^{21}$ & $3.48\times 10^{21}$ \\ 
%Level 3 & $18\,877\,734$ & $1.37\times 10^{15}$ & $2.68\times 10^{15}$ & $4.64\times 10^{15}$  &   &   &  \\ \hline
%Time & &&&&&\\ \hline
%\end{tabular} \vspace*{.4cm}
%\caption{The estimated total number of active nodes on different levels of the search tree in the enumeration of 3-MOLS of orders 9 and 10, as well as the estimated  time that the enumeration would take.}
%\label{activenodes} 
%\end{table}

\begin{table}[t]
\begin{tabular}{ crllllll }
\toprule
 & \multicolumn{1}{c}{ Order 8} & \multicolumn{3}{c}{Order 9}  & \multicolumn{3}{c}{Order 10}   \\ 
\cmidrule(lr){2-2} \cmidrule(lr){3-5}\cmidrule(lr){6-8}
$p$ & \multicolumn{1}{c}{Actual} & \multicolumn{1}{c}{0.4} & \multicolumn{1}{c}{0.5} &\multicolumn{1}{c}{0.6} & \multicolumn{1}{c}{0.4} & \multicolumn{1}{c}{0.5} &\multicolumn{1}{c}{0.6} \\ \midrule[\lightrulewidth]
%Level 0 & 45 & 259 & 259 & 259 & 1700 & 1700 & 1700 \\ 
Level 1 & $15\,948\,763$ & $2.32\times 10^{10}$ & $2.89\times 10^{10}$ & $3.47\times 10^{10}$  & $9.65\times 10^{13}$ & $1.21\times 10^{14}$ & $1.44\times 10^{14}$ \\ 
Level 2 & $1\,546\,241\,258$ & $5.43\times 10^{14}$ & $8.48\times 10^{14}$ & $1.22\times 10^{15}$  & $1.55\times 10^{21}$ & $2.42\times 10^{21}$ & $3.48\times 10^{21}$ \\ 
Level 3 & $18\,877\,734$ & $1.37\times 10^{15}$ & $2.68\times 10^{15}$ & $4.64\times 10^{15}$  & \multicolumn{1}{c}{---}  & \multicolumn{1}{c}{---}  &  \multicolumn{1}{c}{---} \\ \midrule[\lightrulewidth]
%Time ($s$) & $8.36\times 10^{5}$& $1.17\times 10^{13}$ & $1.46\times 10^{13}$ & $1.76\times 10^{13}$&$2.37\times 10^{22}$&$3.70\times 10^{22}$&$5.33\times 10^{22}$\\ 
GHz-days   & 32& $4.51\times 10^{8}$ & $5.64\times 10^{8}$ & $6.77\times 10^{8}$&$9.11\times 10^{17}$&$1.42\times 10^{18}$&$2.05\times 10^{18}$\\ \bottomrule
\end{tabular} \vspace*{.4cm}
\caption{The estimated total number of active nodes on different levels of the search tree for the enumeration of 3-MOLS of orders 9 and 10, as well as the estimated  time that the enumeration would take.}
\label{activenodes} 
\end{table}

\section{Chapter summary}